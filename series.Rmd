--- 
title: "Bookdown template"
author: "Gillard David"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
# output: bookdown::gitbook
documentclass: book
description: "Un mini bookdown concernant l'évolution de différentes choses."
---

# Présentation {#Présentation}

Salut,

Ceci est un super bookdown, il est trop Bien.


1. Visualisation du dashboard concernant le monde
1. visualisation d'un dashboard concernant les continents
1. pour aller plus loin, direction shinyApp:
    - ([shinyapp](https://dgld.shinyapps.io/shinyapp/))
----



**Explication:**

Ce TP est fait dans le but d'apprendre R bookdown.


----

## R ou Python

R est indiqué pour le calcul des nombres et l'analyse statistique alors que Python a l'avantage d'être **extrêmement polyvalent**. L'apprentissage de Python est donc à privilégier si vous souhaitez appliquer les connaissances acquises au niveau de différents types de tâches.



<!--chapter:end:index.Rmd-->

# Evolution Mondiale


```{r setup, include=FALSE}

knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)

library(flexdashboard)

library(tidyverse)

setwd("C:/Users/Cefim/Desktop/cours data/cours_R/seq_bookdown/template_bookdown/template")

# aide
# flexdashboard https://shiny.rstudio.com/articles/dashboards.html



```



## ROW 1 {data-with=650}
------


### Evolution de la population

```{r}

population<-read_delim("WPP2019_POP_F01_1_TOTAL_POPULATION_BOTH_SEXES_UN.csv",                                
                        skip=16,
                        na="...",
                        locale=locale(decimal_mark=","))|> 
                        rename(region=3)  |> 
                        select(region,Type,"1950":"2020") |> 
                        pivot_longer(cols="1950":"2020",
                                     names_to = "annee",
                                     values_to="population")


population_region<-population |> distinct(region)

population |>  
  filter(Type=="World") |> 

ggplot()+
  aes(annee,population,group=1)+
  geom_point()+
  geom_line(size=2)


```



### Evolution de la production de nourriture


```{r}

food<-read_delim("Production_Crops_Livestock_E_All_Data.csv",
                 locale=locale(encoding="ISO-8859-1")) |>
                  select(-ends_with("F")) |> 
                  pivot_longer(cols=Y1961:Y2020,
                               names_to="annee",
                               values_to = "valeur") |> 
                  mutate(annee=str_remove(annee,"Y"))


staple_food_world<-food |> 
  filter(Area=="World",Element=="Production") |> 
  filter(str_detect(Item,pattern="Total"))


ggplot(staple_food_world)+
  aes(x=annee,y=valeur,colour=Item)+
  geom_point()+
  geom_line(aes(group=Item))



```




## ROW 2 {data-with=650}
------

### Evolution de la consommation d'energie par Sources d'énergie


```{r}

energy<-read_delim("owid-energy-data__OWID.csv") |> 
  select(1:3,ends_with("consumption"))|> 
  pivot_longer(cols=4:16,
               names_to="type_energie",
               values_to="consommation")

energy_monde_source<-energy |>
  filter(country=="World") |> 
  filter(type_energie=="biofuel_consumption"|
         type_energie=="coal_consumption"|
         type_energie=="gas_consumption"|
         type_energie=="hydro_consumption"|
         type_energie=="nuclear_consumption"|
         type_energie=="oil_consumption"|
         type_energie=="solar_consumption"|
         type_energie=="wind_consumption")
# 
ggplot(subset(energy_monde_source, consommation > 0))+
  aes(year,consommation,fill=type_energie)+
  #geom_line()+
  geom_col()




```


### Evolution de la consommation d'energie par Type


```{r}

energy_monde_type<-energy |>
  filter(country=="World") |> 
  filter(type_energie=="fossil_fuel_consumption"|
         type_energie=="low_carbon_consumption"|
         type_energie=="other_renewable_consumption"|
         type_energie=="renewables_consumption")

# 
ggplot(energy_monde_type)+
  aes(year,consommation,fill=type_energie)+
  #geom_line()+
  geom_col()


```







<!--chapter:end:worlddashboard.Rmd-->

# Evolution Population / Nourriture / Energie par Continent


```{r setup, include=FALSE}

knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)

library(flexdashboard)

library(tidyverse)

setwd("C:/Users/Cefim/Desktop/cours data/cours_R/seq_bookdown/template_bookdown/template")

# aide
# flexdashboard https://shiny.rstudio.com/articles/dashboards.html


```


## Column 1 {data-width=650}

### Evolution de la population


```{r}


population<-read_delim("WPP2019_POP_F01_1_TOTAL_POPULATION_BOTH_SEXES_UN.csv",                                
                        skip=16,
                        na="...",
                        locale=locale(decimal_mark=","))|> 
                        rename(region=3)  |> 
                        select(region,Type,"1950":"2020") |> 
                        pivot_longer(cols="1950":"2020",
                                     names_to = "annee",
                                     values_to="population")


population_continent <- population |> 
  filter(Type == "Region")

ggplot(population_continent)+
  aes(annee, population, colour=region, group=1)+
  geom_point()+
  geom_line()+
  labs(x="Année",
       y="Population")



```




## Column 2 {dat-width=350, .tabset}

### Production de Nourriture

```{r}

food<-read_delim("Production_Crops_Livestock_E_All_Data.csv",
                 locale=locale(encoding="ISO-8859-1")) |>
                  select(-ends_with("F")) |> 
                  pivot_longer(cols=Y1961:Y2020,
                               names_to="annee",
                               values_to = "valeur") |> 
                  mutate(annee=str_remove(annee,"Y"))


food_continent <- food |>
  filter( Area=="Africa"|
          Area=="Northern America"|
          Area=="Central America"|
          Area=="South America"|
          Area=="Asia"|
          Area=="Europe"|
          Area=="Oceania",
          Element=="Production") |> 
  filter(str_detect(Item,pattern="Total"))



ggplot(food_continent)+
  aes(x=annee,y=valeur,colour=Item)+
  geom_point()+
  geom_line()+
  facet_grid(~Area)


```


### Consommation d'Energie

```{r}


energy<-read_delim("owid-energy-data__OWID.csv") |> 
  select(1:3,ends_with("consumption"))|> 
  pivot_longer(cols=4:16,
               names_to="type_energie",
               values_to="consommation")


type_energy_continent <- energy |> 
     filter(country=="Africa"|
            country=="South & Central America"|
            country=="North America"|
            country=="Asia Pacific"|
            country=="Europe"|
            country=="Australia") |> 
    filter(type_energie=="biofuel_consumption"|
           type_energie=="coal_consumption"|
           type_energie=="gas_consumption"|
           type_energie=="hydro_consumption"|
           type_energie=="nuclear_consumption"|
           type_energie=="oil_consumption"|
           type_energie=="solar_consumption"|
           type_energie=="wind_consumption")
    

ggplot(type_energy_continent)+
  aes(x=year, y=consommation, colour=type_energie)+
  geom_point()+
  geom_line()+
  facet_grid(~country)


```














<!--chapter:end:continentdashboard.Rmd-->

# Evolution Monde

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)

library(flexdashboard)

library(tidyverse)

library(countrycode)

setwd("C:/Users/Cefim/Desktop/cours data/cours_R/seq_bookdown/template_bookdown/template")


```


Column {data-with=650}
------

### Répartition de la population

```{r}

world <- map_data("world") |> 
  mutate(iso_code2=countrycode(region, origin = "country.name", destination = "iso3c")) |>
  mutate(iso_pays=countrycode(iso_code2, origin = "iso3c", destination = "country.name"))


population<-read_delim("WPP2019_POP_F01_1_TOTAL_POPULATION_BOTH_SEXES_UN.csv",                                
                        skip=16,
                        na="...",
                        locale=locale(decimal_mark=","))|> 
                        rename(region=3)  |> 
                        select(region,Type,"1950":"2020") |> 
                        pivot_longer(cols="1950":"2020",
                                     names_to = "annee",
                                     values_to="population") |> 
                        filter(annee==2020, Type=="Country/Area") |> 
                        mutate(iso_code2=countrycode(region, origin = "country.name", destination = "iso3c")) |>
                        mutate(iso_pays=countrycode(iso_code2, origin = "iso3c", destination = "country.name"))




pop_world <- left_join(world, population, by=c("iso_pays"="iso_pays"))

ggplot(pop_world)+
  aes(long, lat)+
  geom_polygon(aes( fill = population, group = group), colour = "black")+
  scale_fill_viridis_c()



```


Column {data-with=350}
------

### Répartition de la production de nourriture


```{r}


food<-read_delim("Production_Crops_Livestock_E_All_Data.csv",
                 locale=locale(encoding="ISO-8859-1")) |>
                  select(-ends_with("F")) |> 
                  pivot_longer(cols=Y1961:Y2020,
                               names_to="annee",
                               values_to = "valeur") |> 
                  mutate(annee=str_remove(annee,"Y"))|> 
                  filter(Element=="Production") |> 
                  filter(str_detect(Item,pattern="Total"))  |> 
                  mutate(iso_code2=countrycode(Area, origin = "country.name", destination = "iso3c")) |>
                  mutate(iso_pays=countrycode(iso_code2, origin = "iso3c", destination = "country.name")) |> 
                  filter(annee=='2020',Item=="Cereals, Total")
                

food_world <- left_join(world, food, by=c("iso_pays"="iso_pays"))

ggplot(food_world)+
  aes(long, lat)+
  geom_polygon(aes( fill = valeur , group = group), colour = "black")+
  scale_fill_viridis_c()




```



###  Répartition de la consommation d'énergie



```{r}

energy<-read_delim("owid-energy-data__OWID.csv") |> 
  select(1:3,ends_with("consumption"))|> 
  pivot_longer(cols=4:16,
               names_to="type_energie",
               values_to="consommation") |>
  filter(type_energie=="coal_consumption", year=="2000") |> 
  mutate(iso_code2=countrycode(country, origin = "country.name", destination = "iso3c")) |>
  mutate(iso_pays=countrycode(iso_code2, origin = "iso3c", destination = "country.name")) |> 
  filter(consommation > 0)
  
energy_world <- left_join(world, energy, by=c("iso_pays"="iso_pays"))


ggplot(energy_world)+
  aes(long, lat)+
  geom_polygon(aes( fill = consommation , group = group), colour = "black")+
  scale_fill_viridis_c()

```



<!--chapter:end:mapdashboard.Rmd-->

